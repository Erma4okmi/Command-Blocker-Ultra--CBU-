# Command Blocker Ultra (CBU)

**Версия:** 1.12  
**Автор:** Misha Ermakov  
**Компания:** MishkaWorld  
**Версия Minecraft:** 1.21.5  
**Ядро:** Paper

## Описание

Command Blocker Ultra - это продвинутый плагин для блокировки команд на Minecraft серверах с детальной системой проверки прав. Плагин предоставляет строгий контроль доступа к командам, их субкомандам и аргументам.

## Основные возможности

### ✅ Реализованная функциональность:
- **Блокировка команд** - все команды заблокированы по умолчанию
- **Проверка прав** - детальная проверка прав на команды, субкоманды и аргументы
- **Автодополнение** - умное автодополнение с учетом прав игрока
- **Конфигурация** - гибкая настройка через config.yml
- **Перезагрузка** - команда `/cbu reload` для применения изменений
- **Субкоманды** - поддержка сложных команд с субкомандами
- **Алиасы** - поддержка алиасов команд

## Архитектура

### Компоненты плагина:

- **CommandBlockerUltra** - основной класс плагина
- **PermissionChecker** - система проверки прав
- **CommandBlocker** - блокировка команд
- **TabCompleteManager** - автодополнение команд

## Конфигурация

### Структура config.yml:

```yaml
# Обычные команды
commands:
  tp:
    permission: teleport.tp
    aliases: [teleport, tpp]
    arguments:
      arg#1:
        permission: teleport.tp.other
      arg#2:
        permission: teleport.tp.other

# Супер-команды (с субкомандами)
super-commands:
  cmi:
    subcommands:
      gm:
        permission: cmi.command.gm
        arguments:
          arg#1:
            lists:
              survival: cmi.command.gm.survival
              creative: cmi.command.gm.creative
          arg#2:
            permission: cmi.command.gm.other
```

### Типы прав:
- **permission** - право на команду/субкоманду/аргумент
- **lists** - права на конкретные значения аргументов
- **aliases** - алиасы команд

## Команды

### `/cbu reload`
- **Право:** `cbu.reload`
- **Описание:** Перезагружает конфигурацию плагина
- **Использование:** `/cbu reload`

## Установка

### Требования:
- Java 17 или выше
- Maven 3.6+
- Paper 1.21.5

### Сборка:
```bash
# Полная сборка
mvn clean package
```

### Установка:
1. Соберите проект командой `mvn package`
2. Скопируйте файл `target/command-blocker-ultra-1.12.jar` в папку `plugins/`
3. Перезапустите сервер
4. Настройте config.yml под ваши нужды

## Структура проекта

```
src/
├── main/
│   ├── java/
│   │   └── com/
│   │       └── mishkaworld/
│   │           └── cbu/
│   │               ├── CommandBlockerUltra.java
│   │               ├── PermissionChecker.java
│   │               ├── CommandBlocker.java
│   │               └── TabCompleteManager.java
│   └── resources/
│       ├── plugin.yml
│       └── config.yml
pom.xml
README.md
```

## Принцип работы

### Система "всё запрещено, кроме явно разрешённого":

1. **Все команды заблокированы** по умолчанию
2. **Проверка прав** происходит для каждого уровня:
   - Основная команда
   - Субкоманда (если есть)
   - Аргументы (по порядку)
   - Значения аргументов (если указаны списки)
3. **Автодополнение** показывает только доступные варианты
4. **Блокировка** происходит при отсутствии любого из требуемых прав

### Примеры блокировки:
- Игрок без `cmi.command.gm` → команда `/cmi gm` заблокирована
- Игрок без `cmi.command.gm.creative` → команда `/cmi gm creative` заблокирована
- Игрок без `cmi.command.gm.other` → команда `/cmi gm creative player` заблокирована

## Производительность

### Оптимизации:
- ✅ HashMap для быстрого поиска команд
- ✅ Кэширование конфигурации
- ✅ Минимальные объекты
- ✅ Эффективные проверки прав

### Рекомендации:
- **Малый сервер (10-50 игроков):** Незначительная нагрузка
- **Средний сервер (50-200 игроков):** Заметная нагрузка при активном использовании
- **Большой сервер (200+ игроков):** Может потребовать дополнительной оптимизации

## Разработка

### Требования для разработки:
- Java 17+
- Maven 3.6+
- IDE с поддержкой Java (IntelliJ IDEA, Eclipse)

### Команды для разработки:
```bash
# Компиляция
mvn compile

# Создание JAR
mvn package

# Очистка и сборка
mvn clean package
```

## Контакты

**Разработчик:** Misha Ermakov  
**Компания:** MishkaWorld  
**Версия:** 1.12 